numexecutors=22
executor_cores=3
executormemory=40g
executormemoryOverhead=15096
drivermemory=25g
drivermemoryOverhead=15048

keytab_file=/etc/security/keytabs/daasuser.keytab
keytabuser=daasuser@MTN.COM

enablePartitionExtract=true
commonHdfsPath=/FlareData/output_8/
archiveKeyWork=""
hivekeytab_file=/etc/security/keytabs/daasuser.keytab
hivekeytabuser=daasuser@MTN.COM

Databasename=flare_8
RejectedDatabasename=flare_8
DatabaseTables=audit
StageNumber=5

Feeds="NG_RETAILERPROMO SHOP_LOCATOR SMART_APP_CDR DIRECT_CONNECT_CCTP ESM_DYA_METRIC ESM_PMT_METRIC ESM_REFILL_METRIC ESM_SIM_REG_METRIC ESM_SUB_METRIC ESM_UNSUB_METRIC ESM_VTU_VENDING_METRIC HSDP_OPTIN_AUTORENEWAL HSDP_OPTOUT_AUTORENEWAL HSDP_RENEWAL_BASE MA_MONITOR SMART_APP_DOWNLOAD SMART_APP_NEW_USERS SMSC UPC_SUBSCRIPTION SUBSCRIBER_TRANSACTIONS_CDR QMATIC"

MA_MONITOR_REJ_REG="SUBSTRING((SPLIT(FSYS_FILENAME,'\/')[7]),8,8)"
MA_MONITOR_REG="substring(split(reverse(element_at(split(reverse(file_name),'\/'),1)),'_')[2],1,8)"
MA_MONITOR_OPS=MA_MONITOR
MA_MONITOR_OPS_PREV=3
MA_MONITOR_OPS_NEXT=1
MA_MONITOR_IgnoreHDFSCheck=false
MA_MONITOR_OPS_REG="SUBSTRING(NAME, 8, 8)"

SMSC_REJ_REG="SUBSTRING((SPLIT(FSYS_FILENAME,'\/')[7]),7,8)"
SMSC_REG="SUBSTRING((SPLIT(FILE_NAME, '\/')[7]), 7, 8)"
SMSC_OPS=SMSC
SMSC_OPS_PREV=3
SMSC_OPS_NEXT=1
SMSC_IgnoreHDFSCheck=false
SMSC_OPS_REG="SUBSTRING(NAME, 7, 8)"

HSDP_RENEWAL_BASE_REJ_REG="SUBSTRING((SPLIT(FSYS_FILENAME,'\/')[7]),8,8)"
HSDP_RENEWAL_BASE_REG="SUBSTRING((SPLIT(FILE_NAME, '\/')[7]), 8, 8)"
HSDP_RENEWAL_BASE_OPS=HSDP_RENEWAL_BASE
HSDP_RENEWAL_BASE_OPS_PREV=3
HSDP_RENEWAL_BASE_OPS_NEXT=1
HSDP_RENEWAL_BASE_IgnoreHDFSCheck=false
HSDP_RENEWAL_BASE_OPS_REG="SUBSTRING(NAME, 8, 8)"

UPC_SUBSCRIPTION_REJ_REG="SUBSTRING((SPLIT(FSYS_FILENAME,'\/')[7]),21,8)"
UPC_SUBSCRIPTION_REG="SUBSTRING((SPLIT(FILE_NAME, '\/')[7]), 21, 8)"
UPC_SUBSCRIPTION_OPS=UPC_SUBSCRIPTION
UPC_SUBSCRIPTION_OPS_PREV=3
UPC_SUBSCRIPTION_OPS_NEXT=1
UPC_SUBSCRIPTION_IgnoreHDFSCheck=false
UPC_SUBSCRIPTION_OPS_REG="SUBSTRING(NAME, 21, 8)"

SMART_APP_DOWNLOAD_REJ_REG="substring(split(reverse(element_at(split(reverse(fsys_filename),'\/'),1)),'_')[3],1,8)"
SMART_APP_DOWNLOAD_REG="substring(split(reverse(element_at(split(reverse(file_name),'\/'),1)),'_')[3],1,8)"
SMART_APP_DOWNLOAD_OPS=SMART_APP_DOWNLOAD
SMART_APP_DOWNLOAD_OPS_PREV=3
SMART_APP_DOWNLOAD_OPS_NEXT=1
SMART_APP_DOWNLOAD_IgnoreHDFSCheck=false
SMART_APP_DOWNLOAD_OPS_REG="DATE_FORMAT(DATE_PARSE(SUBSTRING(NAME,18,8),'%Y%m%d'),'%Y%m%d')"

HSDP_OPTOUT_AUTORENEWAL_REJ_REG="SUBSTRING((SPLIT(FSYS_FILENAME,'\/')[7]),25,8)"
HSDP_OPTOUT_AUTORENEWAL_REG="SUBSTRING((SPLIT(FILE_NAME, '\/')[7]), 25, 8)"
HSDP_OPTOUT_AUTORENEWAL_OPS=HSDP_OPTOUT_AUTORENEWAL
HSDP_OPTOUT_AUTORENEWAL_OPS_PREV=3
HSDP_OPTOUT_AUTORENEWAL_OPS_NEXT=1
HSDP_OPTOUT_AUTORENEWAL_IgnoreHDFSCheck=false
HSDP_OPTOUT_AUTORENEWAL_OPS_REG="SUBSTRING(NAME, 25, 8)"

HSDP_OPTIN_AUTORENEWAL_REJ_REG="SUBSTRING((SPLIT(FSYS_FILENAME,'\/')[7]),24,8)"
HSDP_OPTIN_AUTORENEWAL_REG="SUBSTRING((SPLIT(FILE_NAME, '\/')[7]), 24, 8)"
HSDP_OPTIN_AUTORENEWAL_OPS=HSDP_OPTIN_AUTORENEWAL
HSDP_OPTIN_AUTORENEWAL_OPS_PREV=3
HSDP_OPTIN_AUTORENEWAL_OPS_NEXT=1
HSDP_OPTIN_AUTORENEWAL_IgnoreHDFSCheck=false
HSDP_OPTIN_AUTORENEWAL_OPS_REG="SUBSTRING(NAME, 24, 8)"

DIRECT_CONNECT_CCTP_REJ_REG="SUBSTRING((SPLIT(FSYS_FILENAME,'\/')[7]),5,8)"
DIRECT_CONNECT_CCTP_REG="SUBSTRING((SPLIT(FILE_NAME, '\/')[7]), 5, 8)"
DIRECT_CONNECT_CCTP_OPS=DIRECT_CONNECT_CCTP
DIRECT_CONNECT_CCTP_OPS_PREV=3
DIRECT_CONNECT_CCTP_OPS_NEXT=1
DIRECT_CONNECT_CCTP_IgnoreHDFSCheck=false
DIRECT_CONNECT_CCTP_OPS_REG="SUBSTRING(NAME, 5, 8)"

ESM_DYA_METRIC_REJ_REG="REPLACE(SUBSTRING((SPLIT(FSYS_FILENAME, '\/')[7]), 5, 10),'-')"
ESM_DYA_METRIC_REG="REPLACE(SUBSTRING((SPLIT(FILE_NAME, '\/')[7]), 5, 10),'-')"
ESM_DYA_METRIC_OPS=ESM_DYA_METRIC
ESM_DYA_METRIC_OPS_PREV=3
ESM_DYA_METRIC_OPS_NEXT=1
ESM_DYA_METRIC_IgnoreHDFSCheck=false
ESM_DYA_METRIC_OPS_REG="REPLACE(SUBSTRING(NAME, 5, 10),'-')"

ESM_SUB_METRIC_REJ_REG="SUBSTRING((SPLIT(FSYS_FILENAME,'\/')[7]),5,8)"
ESM_SUB_METRIC_REG="SUBSTRING((SPLIT(FILE_NAME, '\/')[7]), 5, 8)"
ESM_SUB_METRIC_OPS=ESM_SUB_METRIC
ESM_SUB_METRIC_OPS_PREV=3
ESM_SUB_METRIC_OPS_NEXT=1
ESM_SUB_METRIC_IgnoreHDFSCheck=false
ESM_SUB_METRIC_OPS_REG="SUBSTRING(NAME, 5, 8)"

ESM_REFILL_METRIC_REJ_REG="substring(reverse(split(reverse(FSYS_FILENAME),'_')[1]),1,8)"
ESM_REFILL_METRIC_REG="substring(reverse(split(reverse(FILE_NAME),'_')[1]),1,8)"
ESM_REFILL_METRIC_OPS=ESM_REFILL_METRIC
ESM_REFILL_METRIC_OPS_PREV=3
ESM_REFILL_METRIC_OPS_NEXT=1
ESM_REFILL_METRIC_IgnoreHDFSCheck=false
ESM_REFILL_METRIC_OPS_REG="substring(reverse(split(reverse(NAME),'_')[1]),1,8)"

ESM_PMT_METRIC_REJ_REG="REPLACE(SUBSTRING((SPLIT(FSYS_FILENAME, '\/')[7]), 21, 10),'-')"
ESM_PMT_METRIC_REG="REPLACE(SUBSTRING((SPLIT(FILE_NAME, '\/')[7]), 21, 10),'-')"
ESM_PMT_METRIC_OPS=ESM_PMT_METRIC
ESM_PMT_METRIC_OPS_PREV=3
ESM_PMT_METRIC_OPS_NEXT=1
ESM_PMT_METRIC_IgnoreHDFSCheck=false
ESM_PMT_METRIC_OPS_REG="REPLACE(SUBSTRING(NAME, 21, 10),'-')"

ESM_SIM_REG_METRIC_REJ_REG="REPLACE(SUBSTRING((SPLIT(FSYS_FILENAME, '\/')[7]), 27, 10),'-')"
ESM_SIM_REG_METRIC_REG="REPLACE(SUBSTRING((SPLIT(FILE_NAME, '\/')[7]),27,10),'-')"
ESM_SIM_REG_METRIC_OPS=ESM_SIM_REG_METRIC
ESM_SIM_REG_METRIC_OPS_PREV=3
ESM_SIM_REG_METRIC_OPS_NEXT=1
ESM_SIM_REG_METRIC_IgnoreHDFSCheck=false
ESM_SIM_REG_METRIC_OPS_REG="REPLACE(SUBSTRING(NAME, 27, 10),'-')"

ESM_UNSUB_METRIC_REJ_REG="SUBSTRING((SPLIT(FSYS_FILENAME,'\/')[7]),7,8)"
ESM_UNSUB_METRIC_REG="SUBSTRING((SPLIT(FILE_NAME, '\/')[7]), 7, 8)"
ESM_UNSUB_METRIC_OPS=ESM_UNSUB_METRIC
ESM_UNSUB_METRIC_OPS_PREV=3
ESM_UNSUB_METRIC_OPS_NEXT=1
ESM_UNSUB_METRIC_IgnoreHDFSCheck=false
ESM_UNSUB_METRIC_OPS_REG="SUBSTRING(NAME, 7, 8)"

ESM_VTU_VENDING_METRIC_REJ_REG="SUBSTRING((SPLIT(FSYS_FILENAME,'\/')[7]),24,8)"
ESM_VTU_VENDING_METRIC_REG="SUBSTRING((SPLIT(FILE_NAME, '\/')[7]), 24, 8)"
ESM_VTU_VENDING_METRIC_OPS=ESM_VTU_VENDING_METRIC
ESM_VTU_VENDING_METRIC_OPS_PREV=3
ESM_VTU_VENDING_METRIC_OPS_NEXT=1
ESM_VTU_VENDING_METRIC_IgnoreHDFSCheck=false
ESM_VTU_VENDING_METRIC_OPS_REG="SUBSTRING(NAME, 24, 8)"

SMART_APP_NEW_USERS_REJ_REG="DATE_FORMAT(DATE_TRUNC('day', DATE_ADD('day', -1, DATE_PARSE(SUBSTRING((SPLIT(FSYS_FILENAME, '\/')[7]), 18, 8), '%Y%m%d'))), '%Y%m%d')"
SMART_APP_NEW_USERS_REG="substring(split(reverse(element_at(split(reverse(file_name),'\/'),1)),'_')[3],1,8)"
SMART_APP_NEW_USERS_OPS=SMART_APP_NEWUSER
SMART_APP_NEW_USERS_OPS_PREV=3
SMART_APP_NEW_USERS_OPS_NEXT=1
SMART_APP_NEW_USERS_IgnoreHDFSCheck=false
SMART_APP_NEW_USERS_OPS_REG="DATE_FORMAT(DATE_PARSE(SUBSTRING(NAME,18,8),'%Y%m%d'),'%Y%m%d')"

ESM_SIMSWAP_METRIC_REJ_REG="REPLACE(SUBSTRING((SPLIT(FSYS_FILENAME, '\/')[7]), 18, 10),'-')"
ESM_SIMSWAP_METRIC_REG="REPLACE(SUBSTRING((SPLIT(FILE_NAME, '\/')[7]), 18, 10),'-')"
ESM_SIMSWAP_METRIC_OPS=ESM_SIMSWAP_METRIC
ESM_SIMSWAP_METRIC_OPS_PREV=3
ESM_SIMSWAP_METRIC_OPS_NEXT=1
ESM_SIMSWAP_METRIC_IgnoreHDFSCheck=false
ESM_SIMSWAP_METRIC_OPS_REG="REPLACE(SUBSTRING(NAME, 18, 10),'-')"

SMART_APP_CDR_REJ_REG="REPLACE(SUBSTRING((SPLIT(FSYS_FILENAME, '\/')[7]), 30, 10),'-')"
SMART_APP_CDR_REG="REPLACE(SUBSTRING((SPLIT(FILE_NAME, '\/')[7]), 30, 10),'-')"
SMART_APP_CDR_OPS=SMART_APP_CDR
SMART_APP_CDR_OPS_PREV=3
SMART_APP_CDR_OPS_NEXT=1
SMART_APP_CDR_IgnoreHDFSCheck=false
SMART_APP_CDR_OPS_REG="REPLACE(SUBSTRING(NAME, 30, 10),'-')"

NG_RETAILERPROMO_REJ_REG="SUBSTRING((SPLIT(FSYS_FILENAME,'\/')[7]),13,8)"
NG_RETAILERPROMO_REG="SUBSTRING((SPLIT(FILE_NAME, '\/')[7]), 13, 8)"
NG_RETAILERPROMO_OPS=NG_USIM
NG_RETAILERPROMO_OPS_PREV=3
NG_RETAILERPROMO_OPS_NEXT=1
NG_RETAILERPROMO_IgnoreHDFSCheck=false
NG_RETAILERPROMO_OPS_REG="SUBSTRING(NAME, 13, 8)"

SHOP_LOCATOR_REJ_REG="SUBSTRING((SPLIT(FSYS_FILENAME,'\/')[7]),8,8)"
SHOP_LOCATOR_REG="SUBSTRING((SPLIT(FILE_NAME, '\/')[7]), 8, 8)"
SHOP_LOCATOR_OPS=SHOP_LOCATOR
SHOP_LOCATOR_OPS_PREV=3
SHOP_LOCATOR_OPS_NEXT=1
SHOP_LOCATOR_IgnoreHDFSCheck=false
SHOP_LOCATOR_OPS_REG="SUBSTRING(NAME, 8, 8)"

ESM_EXTRATIME_METRIC_REJ_REG="substring(split(split(fsys_filename,'\/')[cardinality(split(fsys_filename,'\/'))],'_')[2],1,8)"
ESM_EXTRATIME_METRIC_REG="substring(split(split(file_name,'\/')[cardinality(split(file_name,'\/'))],'_')[2],1,8)"
ESM_EXTRATIME_METRIC_OPS=ESM_EXTRATIME_METRIC
ESM_EXTRATIME_METRIC_OPS_PREV=3
ESM_EXTRATIME_METRIC_OPS_NEXT=1
ESM_EXTRATIME_METRIC_IgnoreHDFSCheck=false
ESM_EXTRATIME_METRIC_OPS_REG="SUBSTRING(NAME, 10, 8)"

QMATIC_REJ_REG="substring(reverse(split(reverse(FSYS_FILENAME),'_')[1]),1,8)"
QMATIC_REG="substring(reverse(split(reverse(FILE_NAME),'_')[1]),1,8)"
QMATIC_OPS=QMATIC
QMATIC_OPS_PREV=3
QMATIC_OPS_NEXT=1
QMATIC_IgnoreHDFSCheck=false
QMATIC_OPS_REG="substring(reverse(split(reverse(NAME),'_')[1]),1,8)"

SUBSCRIBER_TRANSACTIONS_CDR_REJ_REG="replace(split(split(fsys_filename,'\/')[7],'.')[3],'-','')"
SUBSCRIBER_TRANSACTIONS_CDR_REG="replace(split(split(file_name,'\/')[7],'.')[3],'-','')"
SUBSCRIBER_TRANSACTIONS_CDR_OPS=SMART_APP_SERVICE_CDR
SUBSCRIBER_TRANSACTIONS_CDR_OPS_PREV=3
SUBSCRIBER_TRANSACTIONS_CDR_OPS_NEXT=1
SUBSCRIBER_TRANSACTIONS_CDR_IgnoreHDFSCheck=false
SUBSCRIBER_TRANSACTIONS_CDR_OPS_REG="replace(split(name,'.')[3],'-','')"

