numexecutors=22
executor_cores=3
executormemory=40g
executormemoryOverhead=15096
drivermemory=25g
drivermemoryOverhead=15048

keytab_file=/etc/security/keytabs/daasuser.keytab
keytabuser=daasuser@MTN.COM

enablePartitionExtract=true
commonHdfsPath=/FlareData/output_8/
archiveKeyWork="archive"
hivekeytab_file=/etc/security/keytabs/daasuser.keytab
hivekeytabuser=daasuser@MTN.COM

Databasename=flare_8
RejectedDatabasename=flare_8
DatabaseTables=audit
StageNumber=2

Feeds="RECON CIS_CDR USSD_TRAFFIC_SUCCESS_RATE SMSC_ERROR_BREAKDOWN_PER_ACCOUNT SMSC_TOTAL_DELIVERY_SUCCESS_RATE SMSC_LICENSE SMSC_A2P_P2P_P2A_A2A_SUCCESS_RATE CGW_API IB_API SAG_API UT_DUMP "


RECON_REG="substring(split(reverse(split(reverse(file_name),'\/')[1]),'_')[3],1,8)"
RECON_REJ_REG="substring(split(reverse(split(reverse(fsys_filename),'\/')[1]),'_')[3],1,8)"
RECON_OPS=RECON
RECON_OPS_NEXT=1
RECON_OPS_PREV=3
RECON_IgnoreHDFSCheck=false
RECON_OPS_REG="substring(split(reverse(split(reverse(name),'\/')[1]),'_')[3],1,8)"
CIS_CDR_REG="substring(split((split(file_name,'\/')[cardinality(split(file_name,'\/'))]),'_')[5],5,8)||substring(split((split(file_name,'\/')[cardinality(split(file_name,'\/'))]),'_')[5],3,2)||substring(split((split(file_name,'\/')[cardinality(split(file_name,'\/'))]),'_')[5],1,2)"
CIS_CDR_REJ_REG="substring(split((split(fsys_filename,'\/')[cardinality(split(fsys_filename,'\/'))]),'_')[5],5,8)||substring(split((split(fsys_filename,'\/')[cardinality(split(fsys_filename,'\/'))]),'_')[5],3,2)||substring(split((split(fsys_filename,'\/')[cardinality(split(fsys_filename,'\/'))]),'_')[5],1,2)"
CIS_CDR_OPS=CIS_CDR
CIS_CDR_OPS_NEXT=1
CIS_CDR_OPS_PREV=3
CIS_CDR_IgnoreHDFSCheck=false
CIS_CDR_OPS_REG="concat('2020',substring(regexp_extract(name, '^.*_([0-9]{4})([0-9]{2}).*$', 1),3,2),substring(regexp_extract(name, '^.*_([0-9]{4})([0-9]{2}).*$', 1),1,2))"
USSD_TRAFFIC_SUCCESS_RATE_REG="replace(reverse(split(reverse(file_name),'_')[2]),'-','')"
USSD_TRAFFIC_SUCCESS_RATE_REJ_REG="replace(reverse(split(reverse(fsys_filename),'_')[2]),'-','')"
USSD_TRAFFIC_SUCCESS_RATE_OPS=USSD_TRAFFIC_SUCCESS_RATE
USSD_TRAFFIC_SUCCESS_RATE_OPS_NEXT=1
USSD_TRAFFIC_SUCCESS_RATE_OPS_PREV=3
USSD_TRAFFIC_SUCCESS_RATE_IgnoreHDFSCheck=false
USSD_TRAFFIC_SUCCESS_RATE_OPS_REG="replace(reverse(split(reverse(name),'_')[2]),'-','')"
SMSC_ERROR_BREAKDOWN_PER_ACCOUNT_BREAKDOWN_REG="substring(split((split(file_name,'\/')[cardinality(split(file_name,'\/'))]),'_')[8],1,8)"
SMSC_ERROR_BREAKDOWN_PER_ACCOUNT_BREAKDOWN_REJ_REG="substring(split((split(fsys_filename,'\/')[cardinality(split(fsys_filename,'\/'))]),'_')[8],1,8)"
SMSC_ERROR_BREAKDOWN_PER_ACCOUNT_BREAKDOWN_OPS=SMSC_ERROR_BREAKDOWN_PER_ACCOUNT_BREAKDOWN
SMSC_ERROR_BREAKDOWN_PER_ACCOUNT_BREAKDOWN_OPS_NEXT=1
SMSC_ERROR_BREAKDOWN_PER_ACCOUNT_BREAKDOWN_OPS_PREV=3
SMSC_ERROR_BREAKDOWN_PER_ACCOUNT_BREAKDOWN_IgnoreHDFSCheck=false
SMSC_ERROR_BREAKDOWN_PER_ACCOUNT_BREAKDOWN_OPS_REG="substring(name,1,8)"
SMSC_ERROR_BREAKDOWN_PER_ACCOUNT_REG="replace(reverse(split(reverse(file_name),'_')[2]),'-','')"
SMSC_ERROR_BREAKDOWN_PER_ACCOUNT_REJ_REG="replace(reverse(split(reverse(fsys_filename),'_')[2]),'-','')"
SMSC_ERROR_BREAKDOWN_PER_ACCOUNT_OPS=SMSC_ERROR_BREAKDOWN_PER_ACCOUNT
SMSC_ERROR_BREAKDOWN_PER_ACCOUNT_OPS_NEXT=1
SMSC_ERROR_BREAKDOWN_PER_ACCOUNT_OPS_PREV=3
SMSC_ERROR_BREAKDOWN_PER_ACCOUNT_IgnoreHDFSCheck=false
SMSC_ERROR_BREAKDOWN_PER_ACCOUNT_OPS_REG="replace(reverse(split(reverse(name),'_')[2]),'-','')"
SMSC_TOTAL_DELIVERY_SUCCESS_RATE_REG="replace(reverse(split(reverse(file_name),'_')[2]),'-','')"
SMSC_TOTAL_DELIVERY_SUCCESS_RATE_REJ_REG="replace(reverse(split(reverse(fsys_filename),'_')[2]),'-','')"
SMSC_TOTAL_DELIVERY_SUCCESS_RATE_OPS=SMSC_TOTAL_DELIVERY_SUCCESS_RATE
SMSC_TOTAL_DELIVERY_SUCCESS_RATE_OPS_NEXT=1
SMSC_TOTAL_DELIVERY_SUCCESS_RATE_OPS_PREV=3
SMSC_TOTAL_DELIVERY_SUCCESS_RATE_IgnoreHDFSCheck=false
SMSC_TOTAL_DELIVERY_SUCCESS_RATE_OPS_REG="replace(reverse(split(reverse(name),'_')[2]),'-','')"
SMSC_LICENSE_REG="replace(reverse(split(reverse(file_name),'_')[2]),'-','')"
SMSC_LICENSE_REJ_REG="replace(reverse(split(reverse(fsys_filename),'_')[2]),'-','')"
SMSC_LICENSE_OPS=SMSC_LICENSE
SMSC_LICENSE_OPS_NEXT=1
SMSC_LICENSE_OPS_PREV=3
SMSC_LICENSE_IgnoreHDFSCheck=false
SMSC_LICENSE_OPS_REG="replace(reverse(split(reverse(name),'_')[2]),'-','')"
SMSC_A2P_P2P_P2A_A2A_SUCCESS_RATE_REG="replace(reverse(split(reverse(file_name),'_')[2]),'-','')"
SMSC_A2P_P2P_P2A_A2A_SUCCESS_RATE_REJ_REG="replace(reverse(split(reverse(fsys_filename),'_')[2]),'-','')"
SMSC_A2P_P2P_P2A_A2A_SUCCESS_RATE_OPS=SMSC_A2P_P2P_P2A_A2A_SUCCESS_RATE
SMSC_A2P_P2P_P2A_A2A_SUCCESS_RATE_OPS_NEXT=1
SMSC_A2P_P2P_P2A_A2A_SUCCESS_RATE_OPS_PREV=3
SMSC_A2P_P2P_P2A_A2A_SUCCESS_RATE_IgnoreHDFSCheck=false
SMSC_A2P_P2P_P2A_A2A_SUCCESS_RATE_OPS_REG="replace(reverse(split(reverse(name),'_')[2]),'-','')"
CGW_API_REG="substring(split((split(file_name,'\/')[cardinality(split(file_name,'\/'))]),'_')[3],1,8)"
CGW_API_REJ_REG="substring(split((split(fsys_filename,'\/')[cardinality(split(fsys_filename,'\/'))]),'_')[3],1,8)"
CGW_API_OPS=CGW_API
CGW_API_OPS_NEXT=1
CGW_API_OPS_PREV=3
CGW_API_IgnoreHDFSCheck=false
CGW_API_OPS_REG="substring(name,11,8)"
IB_API_REG="substring(split((split(file_name,'\/')[cardinality(split(file_name,'\/'))]),'_')[3],1,8)"
IB_API_REJ_REG="substring(split((split(fsys_filename,'\/')[cardinality(split(fsys_filename,'\/'))]),'_')[3],1,8)"
IB_API_OPS=IB_API
IB_API_OPS_NEXT=1
IB_API_OPS_PREV=3
IB_API_IgnoreHDFSCheck=false
IB_API_OPS_REG="substring(name,10,8)"
SAG_API_REG="substring(split((split(file_name,'\/')[cardinality(split(file_name,'\/'))]),'_')[3],1,8)"
SAG_API_REJ_REG="substring(split((split(fsys_filename,'\/')[cardinality(split(fsys_filename,'\/'))]),'_')[3],1,8)"
SAG_API_OPS=SAG_API
SAG_API_OPS_NEXT=1
SAG_API_OPS_PREV=3
SAG_API_IgnoreHDFSCheck=false
SAG_API_OPS_REG="substring(name,11,8)"

UT_DUMP_REJ_REG="substring((reverse(element_at(split(reverse(fsys_filename), '\/'), 1))),12,8)"
UT_DUMP_REG="substring((reverse(element_at(split(reverse(file_name), '\/'), 1))),12,8)"
UT_DUMP_OPS=UT_DUMP
UT_DUMP_OPS_PREV=3
UT_DUMP_OPS_NEXT=1
UT_DUMP_IgnoreHDFSCheck=false
UT_DUMP_OPS_REG="substring(name,12,8)"


