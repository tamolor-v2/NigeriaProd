select
msisdn_key as MSISDN_NSK,
date_key as IC_DATE,
case when try_cast(substr(cast(ONNET_OG_FREE_MOU as varchar),index(cast(ONNET_OG_FREE_MOU as varchar),'.')+1) as integer)>0 then try_cast(try_cast(try_cast(cast(ONNET_OG_FREE_MOU as varchar) as decimal(18,2)) as double) as varchar) else substr(cast(ONNET_OG_FREE_MOU as varchar),1,index(cast(ONNET_OG_FREE_MOU as varchar),'.')-1) end as ONNET_OG_FREE_MOU,
case when try_cast(substr(cast(ONNET_OG_PAID_MOU as varchar),index(cast(ONNET_OG_PAID_MOU as varchar),'.')+1) as integer)>0 then try_cast(try_cast(try_cast(cast(ONNET_OG_PAID_MOU as varchar) as decimal(18,2)) as double) as varchar) else substr(cast(ONNET_OG_PAID_MOU as varchar),1,index(cast(ONNET_OG_PAID_MOU as varchar),'.')-1) end as ONNET_OG_PAID_MOU,
case when try_cast(substr(cast(OFFNET_OG_FREE_MOU as varchar),index(cast(OFFNET_OG_FREE_MOU as varchar),'.')+1) as integer)>0 then try_cast(try_cast(try_cast(cast(OFFNET_OG_FREE_MOU as varchar) as decimal(18,2)) as double) as varchar) else substr(cast(OFFNET_OG_FREE_MOU as varchar),1,index(cast(OFFNET_OG_FREE_MOU as varchar),'.')-1) end as OFFNET_OG_FREE_MOU,
case when try_cast(substr(cast(OFFNET_OG_PAID_MOU as varchar),index(cast(OFFNET_OG_PAID_MOU as varchar),'.')+1) as integer)>0 then try_cast(try_cast(try_cast(cast(OFFNET_OG_PAID_MOU as varchar) as decimal(18,2)) as double) as varchar) else substr(cast(OFFNET_OG_PAID_MOU as varchar),1,index(cast(OFFNET_OG_PAID_MOU as varchar),'.')-1) end as OFFNET_OG_PAID_MOU,
case when try_cast(substr(cast(LOCAL_OG_MOU as varchar),index(cast(LOCAL_OG_MOU as varchar),'.')+1) as integer)>0 then try_cast(try_cast(try_cast(cast(LOCAL_OG_MOU as varchar) as decimal(18,2)) as double) as varchar) else substr(cast(LOCAL_OG_MOU as varchar),1,index(cast(LOCAL_OG_MOU as varchar),'.')-1) end as LOCAL_OG_MOU,
case when try_cast(substr(cast(IDD_OG_MOU as varchar),index(cast(IDD_OG_MOU as varchar),'.')+1) as integer)>0 then try_cast(try_cast(try_cast(cast(IDD_OG_MOU as varchar) as decimal(18,2)) as double) as varchar) else substr(cast(IDD_OG_MOU as varchar),1,index(cast(IDD_OG_MOU as varchar),'.')-1) end as IDD_OG_MOU,
coalesce(VOICE_DOU,0) VOICE_DOU,
case when try_cast(substr(cast(onnet_og_revenue as varchar),index(cast(onnet_og_revenue as varchar),'.')+1) as integer)>0 then try_cast(try_cast(try_cast(cast(onnet_og_revenue as varchar) as decimal(18,2)) as double) as varchar) else substr(cast(onnet_og_revenue as varchar),1,index(cast(onnet_og_revenue as varchar),'.')-1) end as ONNET_OG_REV,
case when try_cast(substr(cast(offnet_og_revenue as varchar),index(cast(offnet_og_revenue as varchar),'.')+1) as integer)>0 then try_cast(try_cast(try_cast(cast(offnet_og_revenue as varchar) as decimal(18,2)) as double) as varchar) else substr(cast(offnet_og_revenue as varchar),1,index(cast(offnet_og_revenue as varchar),'.')-1) end as OFFNET_OG_REV,
case when try_cast(substr(cast(LOCAL_OG_REVENUE as varchar),index(cast(LOCAL_OG_REVENUE as varchar),'.')+1) as integer)>0 then try_cast(try_cast(try_cast(cast(LOCAL_OG_REVENUE as varchar) as decimal(18,2)) as double) as varchar) else substr(cast(LOCAL_OG_REVENUE as varchar),1,index(cast(LOCAL_OG_REVENUE as varchar),'.')-1) end as LOCAL_OG_REVENUE,
case when try_cast(substr(cast(IDD_OG_REVENUE as varchar),index(cast(IDD_OG_REVENUE as varchar),'.')+1) as integer)>0 then try_cast(try_cast(try_cast(cast(IDD_OG_REVENUE as varchar) as decimal(18,2)) as double) as varchar) else substr(cast(IDD_OG_REVENUE as varchar),1,index(cast(IDD_OG_REVENUE as varchar),'.')-1) end as IDD_OG_REVENUE,
case when try_cast(substr(cast(TOTAL_OG_REVENUE as varchar),index(cast(TOTAL_OG_REVENUE as varchar),'.')+1) as integer)>0 then try_cast(try_cast(try_cast(cast(TOTAL_OG_REVENUE as varchar) as decimal(18,2)) as double) as varchar) else substr(cast(TOTAL_OG_REVENUE as varchar),1,index(cast(TOTAL_OG_REVENUE as varchar),'.')-1) end as TOTAL_OG_REVENUE,
case when try_cast(substr(cast(idd_roaming_og_usage as varchar),index(cast(idd_roaming_og_usage as varchar),'.')+1) as integer)>0 then try_cast(try_cast(try_cast(cast(idd_roaming_og_usage as varchar) as decimal(18,2)) as double) as varchar) else substr(cast(idd_roaming_og_usage as varchar),1,index(cast(idd_roaming_og_usage as varchar),'.')-1) end as ROAM_OG_USAGE,
case when try_cast(substr(cast(idd_roaming_og_revenue as varchar),index(cast(idd_roaming_og_revenue as varchar),'.')+1) as integer)>0 then try_cast(try_cast(try_cast(cast(idd_roaming_og_revenue as varchar) as decimal(18,2)) as double) as varchar) else substr(cast(idd_roaming_og_revenue as varchar),1,index(cast(idd_roaming_og_revenue as varchar),'.')-1) end as ROAM_OG_REVENUE,
coalesce(idd_roaming_og_call_count,0) as ROAM_OG_CALL_CNT,
coalesce(TOTAL_DOU,0) TOTAL_DOU
from nigeria.cm_usg_voice_og_sit_f;