{
  "presto.config": {
    "connection.string": "jdbc:presto://master01004.mtn.com:8099/hive5/",
    "username": "test",
    "password": ""
  },
  "global": {
    "src.dir": "/FlareData/output_8",
    "har.dir": "/FlareData_har"
  },
  "consolidation.tool.config.template": "/mnt/beegfs/tools/Consolidation/config/consolidation_template.cfg",
  "feeds": [
    {
      "name": "CS5_CCN_VOICE_MA",
      "v.queries": [
        "select count(*) as cnt , count( distinct msisdn_key ) msisdn_key , sum(cast(coalesce ( (case when  callduration='' then '0' else callduration end) , '0') as int)) from flare_8.cs5_ccn_voice_ma where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
    {
      "name": "CS5_CCN_VOICE_DA",
      "v.queries": [
        "select count(*) as cnt , count( distinct msisdn_key ) msisdn_key , sum(cast(coalesce ( (case when duration='' then '0' else duration end) , '0') as int)) from flare_8.cs5_ccn_voice_da where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
    {
      "name": "CS5_CCN_VOICE_AC",
      "v.queries": [
        "select count(*) as cnt , count( distinct msisdn_key ) msisdn_key , sum(cast(coalesce ( (case when duration='' then '0' else duration end) , '0') as int)) from flare_8.cs5_ccn_voice_ac where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
    {
      "name": "CS5_CCN_SMS_DA",
      "v.queries": [
        "select count(*) as cnt , count( distinct msisdn_key ) msisdn_key , sum( cast ( round( cast(coalesce( (case when dedicatedaccountchange='' then '0.0' else dedicatedaccountchange end) , '0.0') as double)) as int)) as dedicatedaccountchange from flare_8.cs5_ccn_sms_da where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
    {
      "name": "CS5_CCN_SMS_MA",
      "v.queries": [
        "select count(*) as cnt , count( distinct msisdn_key ) msisdn_key , sum( cast ( round( cast(coalesce( (case when balanceaftertheevent='' then '0.0' else balanceaftertheevent end) , '0.0') as double)) as int)) as balanceaftertheevent from flare_8.cs5_ccn_sms_ma where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
    {
      "name": "CS5_CCN_GPRS_MA",
      "v.queries": [
        "select count(*)  as cnt , count(distinct MSISDN_key) as msisdn_key ,sum( cast( round( cast(coalesce (case when costofsession = '' then '0' else costofsession end ,'0') as double)) as int)) as costofsession from flare_8.cs5_ccn_gprs_ma where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
    {
      "name": "CS5_CCN_GPRS_DA",
      "v.queries": [
        "select count(*)  as cnt , count(distinct MSISDN_key) as msisdn_key ,sum(cast(round(cast(coalesce (case when dedicatedaccountchange = '' then '0' else dedicatedaccountchange end ,'0') as double)) as int)) as dedicatedaccountchange from  flare_8.cs5_ccn_gprs_da where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
    {
      "name": "BUNDLE4U_GPRS",
      "v.queries": [
        "select count(*) as cnt, count(distinct MSISDN_key) as MSISDN_key ,sum( cast(round(cast(coalesce (case when balance_before_session = '' then '0' else balance_before_session end,'0') as double))as int)) as balance_before_session from flare_8.bundle4u_gprs where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
    {
      "name": "BUNDLE4U_VOICE",
      "v.queries": [
        "select count(*) as cnt , count(distinct MSISDN_key) as MSISDN_key , sum(cast(round(cast(coalesce (case when call_duration = '' then '0' else call_duration end,'0') as double))as int)) as call_duration from flare_8.bundle4u_voice where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
    {
      "name": "CS5_AIR_ADJ_DA",
      "v.queries": [
        "select  count(*) as cnt ,count(distinct MSISDN_key) as MSISDN_key  from flare_8.cs5_air_adj_da where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },{
  "name": "CB_SERV_MAST_VIEW",
  "v.queries": [
    "select  count(*) as cnt ,count(distinct MSISDN_key) as MSISDN_key  from flare_8.cb_serv_mast_view where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
  ],
  "src.dir": "/FlareData/output_8",
  "har.dir": "/FlareData_har"
}
,
 {
      "name": "CS5_SDP_ACC_ADJ_MA",
      "v.queries": [
        "select count(*) as cnt , count(distinct MSISDN_key) as MSISDN_key , sum(cast(round(cast(coalesce (case when  balancebefore = '' then '0' else balancebefore end,'0') as double))as int)) as  balancebefore from flare_8.cs5_sdp_acc_adj_ma where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
{
      "name": "CS5_SDP_ACC_ADJ_DA",
      "v.queries": [
        "select count(*) as cnt , count(distinct MSISDN_key) as MSISDN_key , sum(cast(round(cast(coalesce (case when adjustmentamount = '' then '0' else adjustmentamount end,'0') as double))as int)) as  adjustmentamount from flare_8.CS5_SDP_ACC_ADJ_DA where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    }, {
      "name": "CS5_AIR_REFILL_MA",
      "v.queries": [
        "select count(*) as cnt , count(distinct MSISDN_key) as MSISDN_key , sum(cast(round(cast(coalesce (case when  transactionamount = '' then '0' else transactionamount end,'0') as double))as int)) as  transactionamount from flare_8.cs5_air_refill_ma where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
{
  "name": "CS5_CCN_GPRS_AC",
  "v.queries": [
    "select  count(*) as cnt ,count(distinct MSISDN_key) as MSISDN_key  from flare_8.cs5_ccn_gprs_ac where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
  ],
  "src.dir": "/FlareData/output_8",
  "har.dir": "/FlareData_har"
},
{
  "name": "CS5_CCN_SMS_AC",
  "v.queries": [
    "select  count(*) as cnt ,count(distinct MSISDN_key) as MSISDN_key  from flare_8.cs5_ccn_sms_ac where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
  ],
  "src.dir": "/FlareData/output_8",
  "har.dir": "/FlareData_har"
},
{
      "name": "CS5_AIR_REFILL_DA",
      "v.queries": [
        "select count(*) as cnt , count(distinct MSISDN_key) as MSISDN_key , sum(cast(round(cast(coalesce (case when  refilldivisionamount____1 = '' then '0' else refilldivisionamount____1 end,'0') as double))as int)) as  refilldivisionamount____1 from flare_8.CS5_AIR_REFILL_DA where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
{
  "name": "CS5_SDP_ACC_ADJ_AC",
  "v.queries": [
    "select  count(*) as cnt ,count(distinct MSISDN_key) as MSISDN_key  from flare_8.cs5_sdp_acc_adj_ac where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
  ],
  "src.dir": "/FlareData/output_8",
  "har.dir": "/FlareData_har"
},
{
      "name": "CS5_AIR_REFILL_AC",
      "v.queries": [
        "select count(*) as cnt , count(distinct MSISDN_key) as MSISDN_key from flare_8.CS5_AIR_REFILL_AC where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
{
  "name": "CUG_ACCESS_FEES",
  "v.queries": [
    "select  count(*) as cnt ,count(distinct MSISDN_key) as MSISDN_key  from flare_8.cug_access_fees where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
  ],
  "src.dir": "/FlareData/output_8",
  "har.dir": "/FlareData_har"
},
{
  "name": "DMC_DUMP_ALL",
  "v.queries": [
    "select  count(*) as cnt ,count(distinct MSISDN_key) as MSISDN_key  from flare_8.dmc_dump_all where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
  ],
  "src.dir": "/FlareData/output_8",
  "har.dir": "/FlareData_har"
}
,{
  "name": "DPI_CDR_new",
  "v.queries": [
    "select  count(*) as cnt ,count(distinct MSISDN_key) as MSISDN_key , sum(duration) duration from flare_8.dpi_cdr where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
  ],
  "src.dir": "/FlareData/output_8",
  "har.dir": "/FlareData_har"
}
   
   ,{
  "name": "DpiCdrUnpack",
  "v.queries": [
    "select  count(*) as cnt ,count(distinct MSISDN_key) as MSISDN_key , sum(duration) duration from flare_8.dpi_cdr_unpack where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
  ],
  "src.dir": "/FlareData/output_8",
  "har.dir": "/FlareData_har"
}
,
{
      "name": "CS5_AIR_ADJ_MA",
      "v.queries": [
        "select count(*) as cnt , count(distinct MSISDN_key) as MSISDN_key , sum(cast(round(cast(coalesce (case when  transactionamount = '' then '0' else transactionamount end,'0') as double))as int)) as  transactionamount from flare_8.CS5_AIR_ADJ_MA where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
{
      "name": "FIN_LOG",
      "v.queries": [
        "select count(*) as cnt , count(distinct MSISDN_key) as MSISDN_key , sum(cast(round(cast(coalesce (case when  instruct_amount = '' then '0' else instruct_amount end,'0') as double))as int)) as  instruct_amount from flare_8.fin_log where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
{
  "name": "GGSN_CDR",
  "v.queries": [
    "select  count(*) as cnt ,count(distinct MSISDN_key) as MSISDN_key  from flare_8.ggsn_cdr where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
  ],
  "src.dir": "/FlareData/output_8",
  "har.dir": "/FlareData_har"
}
    ,
{
  "name": "HSDP_CDR",
  "v.queries": [
    "select  count(*) as cnt ,count(distinct MSISDN_key) as MSISDN_key  from flare_8.hsdp_cdr where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
  ],
  "src.dir": "/FlareData/output_8",
  "har.dir": "/FlareData_har"
},
{
      "name": "WBS_PM_RATED_CDRS",
      "v.queries": [
        "select count(*) as cnt , count(distinct MSISDN_key) as MSISDN_key from flare_8.WBS_PM_RATED_CDRS where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
{
      "name": "MOBILE_MONEY",
      "v.queries": [
        "select count(*) as cnt , count(distinct MSISDN_key) as MSISDN_key , sum(cast(round(cast(coalesce (case when  tranamount = '' then '0' else tranamount end,'0') as double))as int)) as  tranamount from flare_8.MOBILE_MONEY where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
{
  "name": "MAPS2G",
  "v.queries": [
    "select count(*),count(distinct base_station_id),sum(cast(round(cast(coalesce (case when  gis_long_txt = '' then '0' else gis_long_txt end,'0') as double))as int)) as gis_long_txt from flare_8.maps2g where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
  ],
  "src.dir": "/FlareData/output_8",
  "har.dir": "/FlareData_har"
},
{
      "name": "SGSN_CDR",
      "v.queries": [
         "select count(*) as cnt , count(distinct MSISDN_key) as MSISDN_key , sum(cast(round(cast(coalesce (case when  call_duration = 0 then 0.0 else call_duration end,0.0) as double))as int)) as  call_duration from flare_8.SGSN_CDR where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },

{
      "name": "SDP_DMP_MA",
      "v.queries": [
        "select count(*) as cnt , count(distinct MSISDN_key) as MSISDN_key , sum(cast(round(cast(coalesce (case when  account_balance = 0 then 0.0 else account_balance end,0.0) as double))as int)) as  account_balance from flare_8.SDP_DMP_MA where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
{
  "name": "MAPS3G",
  "v.queries": [
    "select count(*),count(distinct base_station_id),sum(cast(round(cast(coalesce (case when  gis_long_txt = '' then '0' else gis_long_txt end,'0') as double))as int)) as gis_long_txt from flare_8.maps2g where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
  ],
  "src.dir": "/FlareData/output_8",
  "har.dir": "/FlareData_har"
},
{
  "name": "MAPS4G",
  "v.queries": [
    "select count(*),count(distinct base_station_id),sum(cast(round(cast(coalesce (case when  gis_long_txt = '' then '0' else gis_long_txt end,'0') as double))as int)) as gis_long_txt from flare_8.maps2g where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
  ],
  "src.dir": "/FlareData/output_8",
  "har.dir": "/FlareData_har"
},
{
      "name": "SDP_DMP_DA",
      "v.queries": [
        "select count(*) as cnt , count( distinct msisdn_key ) msisdn_key , sum( cast ( round( cast(coalesce( (case when dedicatedaccountbalance = '' then '0' else dedicatedaccountbalance end) , '0') as double)) as int)) as dedicatedaccountbalance from flare_8.SDP_DMP_DA where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },{
 "name": "UDC_DUMP",
      "v.queries": [
        "select count(*) as cnt , count( distinct msisdn_key ) msisdn_key , sum( cast ( round( cast(coalesce( (case when cdc = 0 then 0 else cdc end) , 0) as double)) as int)) as cdc from flare_8.UDC_DUMP where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    },
{
      "name": "MSC_CDR",
      "v.queries": [
        "select count(*) as cnt , count( distinct msisdn_key ) msisdn_key , sum( cast ( round( cast(coalesce( (case when data_volume_incoming = '' then '0' else data_volume_incoming end) , '0') as double)) as int)) as data_volume_incoming from flare_8.MSC_CDR where tbl_dt>= ${START_DATE} and tbl_dt<=${END_DATE}"
      ],
      "src.dir": "/FlareData/output_8",
      "har.dir": "/FlareData_har"
    }

  ]
}
