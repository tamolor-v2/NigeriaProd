#! /bin/bash
yest=$(date -d '-2 day' '+%Y%m%d')

mytime() {
date +"%Y%m%d"
}
schemaName="flare_8"
sqlStatement=
echo "use flare_8;" >createTables.sql
declare -a flare8TablesArray=(aa_ad_bonus aa_ad_bundle aa_tariff_data agl_crm_country_map agl_crm_lga_map agl_crm_state_map bib_rgs1 bibfeedfilesinfo bsl_summary_ma_ankit bslv bundle4u_gprs bundle4u_voice call_reason call_reason_monthly cb_serv_mast_view cb_serv_mast_view_test costs_for_profitability cs5_air_adj_da cs5_air_adj_ma cs5_air_refill_ac cs5_air_refill_da cs5_air_refill_ma cs5_ccn_gprs_ac cs5_ccn_gprs_da cs5_ccn_gprs_ma cs5_ccn_sms_ac cs5_ccn_sms_da cs5_ccn_sms_ma cs5_ccn_sms_ma_v cs5_ccn_view_ma_ankit cs5_ccn_voice_ac cs5_ccn_voice_da cs5_ccn_voice_ma cs5_ccn_voice_ma_v cs5_sdp_acc_adj_ac cs5_sdp_acc_adj_da cs5_sdp_acc_adj_ma cs5_sdp_acc_adj_ma_tmp cug_access_fees custeventsmsgdaily customereventsconsolidated customereventslastdate customereventsmsg customereventsmsg_20180108 customerretention daas_rgs1 daas_rgs1_test daasfeedfilesinfo day0 day0_backup_datausage dim_cell_detail_ng dim_feed dim_mccmnc_ng dim_package_ng dim_prefix dim_rgs_vas_data dim_wallet directory_count_summary directory_filesopps_summary directory_filesopps_summary_old dmc_dump_all dpi_cdr dpi_cdr_bsl dpi_cdr_new dpi_cdr_unpack dslcustomersubject event_type_lookup feed_count_transactiondate_summary feeds_count_rejected_summary feeds_count_rejected_summary_old feeds_count_rejected_summary_test feeds_count_stats_summary feeds_count_stats_summary_yousef feeds_count_summary feeds_count_summary_old feeds_count_summary_partition feeds_count_summary_temp feeds_count_summary_yousef feeds_files_partitions feeds_stats file_stats file_stats_structured file_stats_structured_partioned fileopps_report files_count_rejected_detailes files_count_rejected_detailes_old files_count_rejected_detailes_test files_count_rejected_summary files_count_rejected_summary_test files_count_stats_detailes files_count_stats_detailes_yousef files_count_stats_summary files_count_stats_summary_yousef files_count_summary files_count_summary_old files_count_summary_temp files_filesopps_summary files_filesopps_summary_old files_filesopps_summary_partition filetransdatemsg fin_log final_feed_report final_feed_report2 final_feed_report_old final_feed_report_yousef final_feed_report_yousef2 final_files_report final_files_report_old ggsn_cdr hendre_test_sdp_20180422_20180428 hsdp_cdr hsdp_lookup input_file_stats international_icx inv_feed_diffs inv_pokuri_test_01 inv_pokuri_test_03 inv_pokuri_test_temp101 inv_pokuri_test_temp102 inv_pokuri_test_temp103 inv_pokuri_test_temp104 inv_pokuri_test_temp105 location maps2g maps3g maps4g mnp_porting_broadcast mobile_money mobile_money_copy msc_cdr mvas_dnd_msisdn_report newreg_bioupdt_pool offer_plan_information operators pmrated1 pokuri_event_summary pokuri_test_msc_cdr_bucket processdatetransdatemsg recharge recharges_summd recon rejecteddata rejecteddata_old_schema rgs1_bib_excess_msisdns rgs1_daas_excess_msisdns rgseventmsisdn rt_20180301_sms rt_20180301_voice rt_20180301_voice_percountry sdp_dmp_ma service_list sgsn_cdr sms_1 sms_6_final sms_ma_6_1 stage1_activefeeds subcb_serv_mast_view subcs5_air_adj_ma subcs5_air_refill_ma subcs5_ccn_gprs_da tables_count_summary tables_file_count_summary takeon_1031 takeon_test tariff_type testdslcustomersubject tmp_bib_rgs1 w_zoomdata_test w_zoomdata_test1 wbs_pm_rated_cdrs wbs_pm_rated_cdrs_str) 
for table in "${flare8TablesArray[@]}"
do
echo "show create table $table; ">>createTables.sql
done
hive  -S -f  ./createTables.sql >allCreateStatements.txt
#echo $sqlStatement
