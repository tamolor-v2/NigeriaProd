start transaction;
insert into engine_room.MFS_ACQUISITION
select to_hex(md5(to_utf8((coalesce (msisdn,'') )))),    coalesce(id,0),    coalesce(external_id,''),    coalesce(firstname,''),    coalesce(middlename,''),    coalesce(surname,''),    coalesce(dateofbirth,''),    coalesce(gender,''),    coalesce(nationality,''),    coalesce(language,''),    coalesce(occupation,''),    coalesce(addressline1,''),    coalesce(addressline2,''),    coalesce(country,''),    coalesce(id_type,''),    coalesce(id_number,''),    coalesce(email,''),    coalesce(username,''),    coalesce(account_type,''),    coalesce(account_status,''),    coalesce(accountholder_status,''),    coalesce(blackliststatus,''),    coalesce(profile,''),    coalesce(bankdomain,''),    coalesce(employingcompany,''),    coalesce(lastactivitytime,''),    coalesce(registration_date,''),    coalesce(activation_date,''),    coalesce(blacklistdate,''),    coalesce(imsi,''),    coalesce(alias,''),    coalesce(parentaccountholder_id,''),    coalesce(parentaccountholder_msisdn,''),    coalesce(parentaccountholder_email,''),    coalesce(parentaccountholder_username,''),    coalesce(parentaccountholder_imsi,''),    coalesce(recruiter_id,''),    to_hex(md5(to_utf8((coalesce (recruiter_msisdn,'') )))),    coalesce(recruiter_email,''),    coalesce(recruiter_username,''),    coalesce(recruiter_imsi,''),    coalesce(file_name,''),    file_offset,    coalesce(kamanja_loaded_date,''),    coalesce(file_mod_date,''), to_hex(md5(to_utf8((cast(coalesce (msisdn_key,0) as varchar ))))),    date_key ,    event_timestamp_enrich,    coalesce(original_timestamp_enrich,''),    coalesce(msg_unique_id_enrich ,0),    coalesce(base_file_name,''),    coalesce(path,''),    line_number,    coalesce(file_id,''),    processed_timestamp,    ltz_event_timestamp_enrich,yyyymmddRunDate 
from flare_8.EWP_ACCOUNT_HOLDERS_DUMP 
where tbl_dt=yyyymmddRunDate;
commit;
